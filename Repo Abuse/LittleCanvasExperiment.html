
<html>



<head>



<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">



<script type="text/javascript">

var uHeight;

var uWidth;

var xContext;

var fTimer;



var fSRX;

var fSRY;

var fCRX;

var fCRY;



var fTransformedX;

var fTransformedY;



var fCamDistance;



function Initialise()

{

	var canvas = document.getElementById( 'canvas' );

	xContext = canvas.getContext( '2d' );

	uHeight = canvas.height;

	uWidth = canvas.width;

	fTimer = 0.0;

	

	return setInterval( Render, 15 ); // ~60fps

}



function Render()

{

	RenderClear();

	RenderRotate( fTimer, 1.5 * fTimer - 1.0 );

	RenderCameraDistance( 3.0 );

	

	xContext.fillStyle = 'rgba( 255, 255, 255, 1.0 )';

	

	RenderColour( 255, 0, 0, 1.0 );

	RenderQuad(

		1.0, 1.0, 1.0,

		1.0, -1.0, 1.0,

		-1.0, -1.0, 1.0,

		-1.0, 1.0, 1.0,

		0.0, 0.0, 1.0 );

	

	RenderColour( 0, 255, 0, 1.0 );

	RenderQuad(

		1.0, 1.0, -1.0,

		1.0, -1.0, -1.0,

		-1.0, -1.0, -1.0,

		-1.0, 1.0, -1.0,

		0.0, 0.0, -1.0 );

		

	RenderColour( 0, 0, 255, 1.0 );

	RenderQuad(

		1.0, 1.0, 1.0,

		1.0, 1.0, -1.0,

		-1.0, 1.0, -1.0,

		-1.0, 1.0, 1.0,

		0.0, 1.0, 0.0 );

	

	RenderColour( 255, 255, 0, 1.0 );

	RenderQuad(

		1.0, -1.0, 1.0,

		1.0, -1.0, -1.0,

		-1.0, -1.0, -1.0,

		-1.0, -1.0, 1.0,

		0.0, -1.0, 0.0 );

		

	RenderColour( 255, 0, 255, 1.0 );

	RenderQuad(

		1.0, 1.0, 1.0,

		1.0, -1.0, 1.0,

		1.0, -1.0, -1.0,

		1.0, 1.0, -1.0,

		1.0, 0.0, 0.0 );

	

	RenderColour( 0, 255, 255, 1.0 );

	RenderQuad(

		-1.0, 1.0, 1.0,

		-1.0, -1.0, 1.0,

		-1.0, -1.0, -1.0,

		-1.0, 1.0, -1.0,

		-1.0, 0.0, 0.0 );

		

	fTimer += 0.015;

}



function RenderClear() 

{

	xContext.fillStyle = 'rgba( 0, 0, 0, 1.0 )';

	xContext.fillRect( 0, 0, uWidth, uHeight );

}



function RenderRotate( rx, ry )

{

	fSRX = Math.sin( rx );

	fSRY = Math.sin( ry );

	fCRX = Math.cos( rx );

	fCRY = Math.cos( ry );

}



function RenderColour( r, g, b, a )

{

	xContext.fillStyle = 'rgba( ' + r + ', ' + g + ', ' + b + ', ' + a + ' )';

}



function RenderCameraDistance( d )

{

	fCamDistance = d;

}



function RenderTransformVertex( vx, vy, vz )

{

	var ty;

	var tz;

	ty = fCRX * vy - fSRX * vz;

	tz = fSRX * vy + fCRX * vz;

	vz = fCRY * tz - fSRY * vx;

	vx = fSRY * tz + fCRY * vx;

	

	fTransformedX = vx / ( fCamDistance + vz );

	fTransformedY = ty / ( fCamDistance + vz );

	

	var factor = uHeight / 2;

	if( uHeight > uWidth )

	{

		factor = uWidth / 2;

	}

	fTransformedX = ( 1 + fTransformedX ) * factor;

	fTransformedY = ( 1 + fTransformedY ) * factor;

}



function RenderTestNormal( nx, ny, nz, px, py, pz )

{

	var ty;

	var tz;

	ty = fCRX * ny - fSRX * nz;

	tz = fSRX * ny + fCRX * nz;

	nz = fCRY * tz - fSRY * nx;

	nx = fSRY * tz + fCRY * nx;

	ny = ty;

	

	ty = fCRX * py - fSRX * pz;

	tz = fSRX * py + fCRX * pz;

	pz = fCRY * tz - fSRY * px;

	px = fSRY * tz + fCRY * px;

	py = ty;

	

	pz += fCamDistance;

	

	return px * nx + py * ny + pz * nz < 0.0;

}



function RenderQuad(

	v1x, v1y, v1z,

	v2x, v2y, v2z,

	v3x, v3y, v3z,

	v4x, v4y, v4z,

	nx, ny, nz )

{

	if( !RenderTestNormal(

		nx, ny, nz,

		( v1x + v2x + v3x + v4x ) / 4,

		( v1y + v2y + v3y + v4y ) / 4,

		( v1z + v2z + v3z + v4z ) / 4 ) )

	{

		return;

	}

	

	xContext.beginPath();

	

	RenderTransformVertex( v1x, v1y, v1z );

	xContext.moveTo( fTransformedX, fTransformedY );

	RenderTransformVertex( v2x, v2y, v2z );

	xContext.lineTo( fTransformedX, fTransformedY );

	RenderTransformVertex( v3x, v3y, v3z );

	xContext.lineTo( fTransformedX, fTransformedY );

	RenderTransformVertex( v4x, v4y, v4z );

	xContext.lineTo( fTransformedX, fTransformedY );

	

	xContext.fill();

}

</script>



</head>

<canvas id="canvas" width="500" height="500">You need a HTML5 capable browser to view this image.</canvas>

</body>



</html>